# Telegram 聊天机器人使用指南

## 功能说明

这个聊天机器人功能让你可以与 Telegram 机器人对话，自动获取 `chat_id` 并配置到 UptimeGuard 中，用于接收网站监控通知。

## 使用方法

### 方法一：使用启动脚本（推荐）

```bash
# 在虚拟环境中运行
source .venv/bin/activate
python start_chat_bot.py
```

然后选择 "1" 启动聊天机器人。

### 方法二：直接运行聊天机器人

```bash
# 在虚拟环境中运行
source .venv/bin/activate
python telegram_chat_bot.py
```

### 方法三：测试通知功能

```bash
# 在虚拟环境中运行
source .venv/bin/activate
python telegram_chat_bot.py test
```

## 使用步骤

1. **确保已配置 Bot Token**
   - 检查 `telegram_config.json` 中的 `bot_token` 是否已填写
   - 如果为空，请先配置 Bot Token

2. **启动聊天机器人**
   ```bash
   python start_chat_bot.py
   ```

3. **与机器人对话**
   - 机器人会显示其链接，点击链接打开 Telegram
   - 或者搜索机器人用户名（在启动信息中显示）
   - 向机器人发送任意消息，比如 "你好"

4. **自动获取 chat_id**
   - 机器人会自动回复你的消息
   - 在回复中会显示你的 `chat_id`
   - `chat_id` 会自动保存到配置文件中

5. **测试通知功能**
   - 运行测试命令验证配置是否正确
   - 如果收到测试消息，说明配置成功

## 机器人功能

- **自动获取 chat_id**: 收到消息后自动提取并保存聊天 ID
- **友好回复**: 发送欢迎消息并显示配置信息
- **实时监听**: 持续监听新消息，支持多个用户
- **配置管理**: 自动更新配置文件，无需手动编辑

## 配置信息

聊天机器人会自动更新以下配置：

```json
{
  "bot_token": "你的机器人Token",
  "chat_id": "自动获取的聊天ID",
  "enabled": true,
  "failure_threshold": 10
}
```

## 故障排除

### 1. 机器人无响应
- 检查 `bot_token` 是否正确
- 确认网络连接正常
- 查看控制台错误信息

### 2. 无法获取 chat_id
- 确保已向机器人发送消息
- 检查机器人是否在线
- 重新启动聊天机器人

### 3. 通知发送失败
- 运行测试命令检查配置
- 确认 `chat_id` 已正确保存
- 检查机器人权限设置

## 注意事项

- 聊天机器人会持续运行，按 `Ctrl+C` 停止
- 支持多个用户同时与机器人对话
- 每次获取新的 `chat_id` 会覆盖之前的配置
- 建议在私聊中使用，避免群聊中的消息干扰

## 示例输出

```
🤖 启动 UptimeGuard Telegram 聊天机器人...
==================================================
✅ 机器人连接成功: UptimeGuard Bot (@your_bot_username)
🔗 机器人链接: https://t.me/your_bot_username

📱 请向机器人发送任意消息来获取聊天 ID
⏹️  按 Ctrl+C 停止机器人
==================================================

📨 收到来自 张三 的消息: 你好
🆔 聊天 ID: 123456789
✅ 已向 张三 发送欢迎消息
💾 保存聊天 ID: 123456789
✅ 聊天 ID 已成功保存到配置文件中
```

现在你可以轻松地与机器人对话并获取 `chat_id` 了！
